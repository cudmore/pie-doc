



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Raspberry Pi Controlled Experiment (PiE)">
      
      
      
        <meta name="author" content="Robert H Cudmore">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../img/icons/video-camera-blue.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.4">
    
    
      
        <title>Wiring - Behavior Box - PiE Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../#wiring-a-behavior-box" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="PiE Docs" class="md-header-nav__button md-logo">
          
            <img src="../img/icons/video-camera-blue.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                PiE Docs
              </span>
              <span class="md-header-nav__topic">
                Wiring - Behavior Box
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/cudmore/pie" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      PiE Repository
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="PiE Docs" class="md-nav__button md-logo">
      
        <img src="../img/icons/video-camera-blue.png" width="48" height="48">
      
    </a>
    PiE Docs
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/cudmore/pie" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      PiE Repository
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../install/" title="Install" class="md-nav__link">
      Install
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../web-interface/" title="Web Interface" class="md-nav__link">
      Web Interface
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../commander/" title="Commander" class="md-nav__link">
      Commander
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../parts/" title="Parts" class="md-nav__link">
      Parts
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Wiring - Behavior Box
      </label>
    
    <a href="./" title="Wiring - Behavior Box" class="md-nav__link md-nav__link--active">
      Wiring - Behavior Box
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#raspberry-pi-23-pin-out" title="Raspberry Pi 2/3 pin out" class="md-nav__link">
    Raspberry Pi 2/3 pin out
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wiring-the-camera" title="Wiring the camera" class="md-nav__link">
    Wiring the camera
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wiring-diagram" title="Wiring diagram" class="md-nav__link">
    Wiring diagram
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lights" title="Lights" class="md-nav__link">
    Lights
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wiring-the-lights" title="Wiring the lights" class="md-nav__link">
    Wiring the lights
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#connect-a-12v-acdc-adapter-ir-and-white-lights-to-the-two-channel-relay-switch" title="Connect a 12V AC/DC adapter, IR, and white lights to the two-channel relay switch." class="md-nav__link">
    Connect a 12V AC/DC adapter, IR, and white lights to the two-channel relay switch.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect-the-pi-to-the-relay-switch-switch" title="Connect the Pi to the relay switch switch" class="md-nav__link">
    Connect the Pi to the relay switch switch
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wiring-a-temperature-and-humidity-sensor" title="Wiring a temperature and humidity sensor" class="md-nav__link">
    Wiring a temperature and humidity sensor
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#am2302" title="AM2302" class="md-nav__link">
    AM2302
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dht22" title="DHT22" class="md-nav__link">
    DHT22
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../wiring-scope/" title="Wiring - Scope" class="md-nav__link">
      Wiring - Scope
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../wiring-treadmill/" title="Wiring - Treadmill" class="md-nav__link">
      Wiring - Treadmill
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      Extras
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        Extras
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rest-interface/" title="Rest Interface" class="md-nav__link">
      Rest Interface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../trial-file/" title="Trial File" class="md-nav__link">
      Trial File
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gpio-timing/" title="GPIO Timing" class="md-nav__link">
      GPIO Timing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../file-server/" title="File Server" class="md-nav__link">
      File Server
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mount-usb-drive/" title="Mount USB Drive" class="md-nav__link">
      Mount USB Drive
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../implementation-details/" title="Implementation details" class="md-nav__link">
      Implementation details
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../about/" title="About" class="md-nav__link">
      About
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#raspberry-pi-23-pin-out" title="Raspberry Pi 2/3 pin out" class="md-nav__link">
    Raspberry Pi 2/3 pin out
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wiring-the-camera" title="Wiring the camera" class="md-nav__link">
    Wiring the camera
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wiring-diagram" title="Wiring diagram" class="md-nav__link">
    Wiring diagram
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lights" title="Lights" class="md-nav__link">
    Lights
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wiring-the-lights" title="Wiring the lights" class="md-nav__link">
    Wiring the lights
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#connect-a-12v-acdc-adapter-ir-and-white-lights-to-the-two-channel-relay-switch" title="Connect a 12V AC/DC adapter, IR, and white lights to the two-channel relay switch." class="md-nav__link">
    Connect a 12V AC/DC adapter, IR, and white lights to the two-channel relay switch.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect-the-pi-to-the-relay-switch-switch" title="Connect the Pi to the relay switch switch" class="md-nav__link">
    Connect the Pi to the relay switch switch
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wiring-a-temperature-and-humidity-sensor" title="Wiring a temperature and humidity sensor" class="md-nav__link">
    Wiring a temperature and humidity sensor
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#am2302" title="AM2302" class="md-nav__link">
    AM2302
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dht22" title="DHT22" class="md-nav__link">
    DHT22
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="wiring-a-behavior-box">Wiring a behavior box</h1>
<p>Wiring a behavior box is fairly simple. The Pi needs to be wired to one end of a relay/switch, the other end of the relay/switch is wired to 12V DC, IR and white LEDs, and the temperature/humidity sensor is wired to the Pi.</p>
<h2 id="raspberry-pi-23-pin-out">Raspberry Pi 2/3 pin out</h2>
<p><IMG SRC="../img/raspberry_pins.png" width=650></p>
<p>There are multiple power and ground pins, use these to connect to the relay switch and the temperature sensor. Conceptually, all the ground pins are the same, you can use a <a href="https://www.adafruit.com/product/64">bread-board</a> if you run out of ground pins or the wiring becomes too tangled.</p>
<h2 id="wiring-the-camera">Wiring the camera</h2>
<p>The Raspberry Pi <a href="https://www.adafruit.com/product/3100">NoIR camera</a> (and the <a href="https://www.adafruit.com/product/3099">normal Pi camera</a>) is connected to the Pi with a flat [ribbon cable][flat-camera-cable]. The length should not exceed 2 meters. The cable should have one side with a blue tab (one on each end). When connecting the cable to the camera and the Pi, the direction of the blue tab matters. If it is backwards, the camera will not function.</p>
<ul>
<li>The blue side of the cable must go towards the back of the camera.</li>
<li>The blue side of the cable must go towards the ethernet and USB ports.</li>
</ul>
<p>Finally, the camera must be activated from the command line using <code>sudo raspi-config</code> and choosing '5 Interface Options' then 'P1 Camera' and answering 'Yes'.</p>
<h2 id="wiring-diagram">Wiring diagram</h2>
<p><IMG SRC="../img/pie-homecage.png" width=600></p>
<h2 id="lights">Lights</h2>
<p><strong>Use an external 12V AC/DC power supply.</strong> - Don't power the lights directly from the 5V pins on the Pi, the Pi does not have enough current. A &gt;1 Amp 12V adapter should be fine. Don't worry, if it is under-powered, the LED lights will be a little dim.</p>
<p><strong>Use a relay switch.</strong> - Never connect the 12V adapter directly to the Pi, instead use a relay switch. Only work with DC current coming out of the AC/DC adapter, <strong>DO NOT</strong> work with AC power coming from the wall as it can kill you.</p>
<p>The relay switch effectively separates the 5V, Ground, and GPIO on the Pi (left half of the relay) from the 12V power of the AC/DC adapter and the lights (right half of the relay). Here we will wire the system with the white LED on channel 1 and the IR LED on channel 2 of the relay switch. </p>
<p><strong>All LEDs need resistors.</strong> - All LEDs need a resistor, these are called 'current limiting resistor'. If you directly connect an LED to power and ground without a resistor, you will burn the LED.</p>
<p>The value of the resistor (in Ohms) needs to be calculated using <a href="https://en.wikipedia.org/wiki/Ohm%27s_law">Ohms law</a>, V=I*R. Where:</p>
<ul>
<li>V (Volts) is determined by the power source</li>
<li>I (Amps) depends on the properties of each LED and if they are wired in series or in parallel</li>
<li>R (Ohms) is what needs to be calculated.</li>
</ul>
<p>Follow <a href="http://www.resistorguide.com/resistor-for-led/">this</a> tutorial to get started calculating the required resistor value. </p>
<p><strong>Use IR LEDs &lt;900 nm.</strong> - These are within the sensitivity range of the Pi NoIR camera. A lot of IR LEDs are 940nm, these are not well suited for use with the Pi NoIR camera but are designed for IR sensors as is used in a TV remote.</p>
<h2 id="wiring-the-lights">Wiring the lights</h2>
<p><IMG SRC="../img/two-channel-relay.png" width=550></p>
<h3 id="connect-a-12v-acdc-adapter-ir-and-white-lights-to-the-two-channel-relay-switch">Connect a 12V AC/DC adapter, IR, and white lights to the two-channel relay switch.</h3>
<ul>
<li>
<p>Using a 12V AC/DC adapter (&gt;1 Amp), cut the wire and stick the positive 'hot' wire into the center 'common' pin' of channel 1 on the relay switch. The 'hot' end wire usually has a white line down the length of the wire. You can also determine the 'hot' end using a multi-meter, it is the one that gives a positive (+) voltage when attached to the positive (normally red) end of the multi-meter.</p>
</li>
<li>
<p>Cut a bit of wire and connect the center 'common pin' of channel 1 to the center 'common pin' of channel 2. This is the 'hot' end.</p>
</li>
<li>
<p>Stick the positive end of the white LED into the 'normally closed' port of channel 1. Attach the negative end of the white LED to the 'ground' wire of the 12V AC/DC adapter. Remember, all LEDs need resistors!</p>
</li>
<li>
<p>Do the same for the IR LED. Stick the positive end into the 'normally closed' port of channel 2 on the relay switch. Attach the negative end of the IR LED to the 'ground' wire of the 12V AC/DC adapter. Remember, all LEDs need resistors!</p>
</li>
<li>
<p>Tie the three grounds together, this includes the ground from the 12V AC/DC adapter, the white LEDs and the IR LEDs.</p>
</li>
</ul>
<h3 id="connect-the-pi-to-the-relay-switch-switch">Connect the Pi to the relay switch switch</h3>
<p>Connect 4 wires from the Pi to the relay switch. All these wires go on the opposite end from the 12V wires. Look at your relay switch for the correct connects, they are usually clearly labelled but can be in a different order from the image shown.</p>
<ul>
<li>Connect a GPIO pin from the Pi to the 'In1=Digital Input' pin on the relay switch.</li>
<li>Connect a second GPIO pin from the Pi to the 'In2=Digital Input' pin on the relay switch.</li>
<li>Connect a 5V pin from the Pi to the 'Vcc' pin on the relay switch.</li>
<li>Connect a ground pin from the Pi to the 'GND' pin on the relay switch.</li>
</ul>
<h2 id="wiring-a-temperature-and-humidity-sensor">Wiring a temperature and humidity sensor</h2>
<p>The PiE server can log temperature and humidity using the DHT line of temperature sensors. To use these sensors, the <a href="https://github.com/adafruit/DHT-sensor-library">Adafruit Python sensor library</a> needs to to be installed.</p>
<pre><code>cd ~/pie
./install-dht
</code></pre>

<p>There are additional troubleshooting tips in the <a href="https://github.com/cudmore/pie/tree/master/testing">pie/testing/</a> folder.</p>
<p><IMG SRC="../img/am2302.png" width=250 align="right"></p>
<h3 id="am2302"><a href="https://www.adafruit.com/product/393">AM2302</a></h3>
<p>Red is power, black is ground, and yellow is data.</p>
<ul>
<li>Connect a 5V pin from the Pi to the red wire on the sensor.</li>
<li>Connect a ground pin from the Pi to the back wire on the sensor.</li>
<li>Connect a GPIO pin from the Pi to the yellow (data) pin on the sensor.</li>
</ul>
<p><IMG SRC="../img/dht22-pin-out.png" width=250 align="right"></p>
<h3 id="dht22"><a href="https://www.adafruit.com/product/385">DHT22</a></h3>
<ul>
<li>Connect a 5V pin from the Pi to the 'VCC' pin on the sensor.</li>
<li>Connect a ground pin from the Pi to the 'GND' pin on the sensor.</li>
<li>Connect a GPIO pin from the Pi to the 'DATA' pin on the sensor.</li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
      
    </div>
    
      <script src="../assets/javascripts/application.583bbe55.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="../javascripts/extra.js"></script>
      
    
    
      
    
  </body>
</html>